<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>üìã –ü—É—Ç–∏–≤–Ω–∏–π –ª–∏—Å—Ç</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #0057B7;
            --success: #4CAF50;
            --danger: #f44336;
        }
        body {
            font-family: 'Manrope', sans-serif;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 900px; margin: 0 auto; }
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .header h1 { font-size: 2rem; color: var(--primary); margin-bottom: 8px; }
        .card {
            background: white;
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        .card h2 { font-size: 1.3rem; color: #333; margin-bottom: 20px; }
        .form-group { margin-bottom: 20px; }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 0.9rem;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
        }
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 87, 183, 0.1);
        }
        .input-group { position: relative; }
        .input-suffix {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
            pointer-events: none;
        }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--primary) 0%, #003d82 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            margin-top: 10px;
        }
        .btn:hover { transform: translateY(-2px); }
        .hint { display: block; margin-top: 5px; font-size: 0.8rem; color: #999; }
        .auto-calc {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
        }
        .auto-calc-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
        }
        @media print {
            body * { visibility: hidden; }
            #waybillPrint, #waybillPrint * { visibility: visible; }
            #waybillPrint { position: absolute; left: 0; top: 0; width: 100%; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìã –ü—É—Ç–∏–≤–Ω–∏–π –ª–∏—Å—Ç</h1>
            <p>–§–∞–∫—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–µ–π—Å—É</p>
            <div style="margin-top: 10px; padding: 10px; background: #e3f2fd; border-radius: 8px; font-size: 0.85rem; color: #1565c0;">
                ‚ö†Ô∏è –ó–∞–ø–æ–≤–Ω—é—î—Ç—å—Å—è <strong>–ü–Ü–°–õ–Ø</strong> –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–µ–π—Å—É –∑ —Ñ–∞–∫—Ç–∏—á–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏
            </div>
            <div style="margin-top: 10px;">
                <a href="preview_calculator.html" style="display: inline-block; padding: 10px 20px; background: #FF9800; color: white; text-decoration: none; border-radius: 8px; font-weight: 600;">
                    üí∞ –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É
                </a>
            </div>
        </div>

        <div class="card">
            <h2>üë§ –í–æ–¥—ñ–π —Ç–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç</h2>
            <div class="form-group">
                <label for="driver">–í–æ–¥—ñ–π *</label>
                <select id="driver" onchange="selectDriver()">
                    <option value="">-- –í–∏–±–µ—Ä—ñ—Ç—å –≤–æ–¥—ñ—è --</option>
                    <option value="0">–°—Ç–∞—Ä–æ–¥—É–± –°–µ—Ä–≥—ñ–π –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á</option>
                    <option value="1">–ù–∞—Ä–∏–≤–æ–Ω—á–∏–∫ –û–ª–µ–∫—Å–∞–Ω–¥—Ä –í–∞—Å–∏–ª—å–æ–≤–∏—á</option>
                    <option value="2">–î–∏–º–æ–≥–ª–æ–≤ –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤–∏—á</option>
                    <option value="3">–¢—É—Ä–∫—ñ–≤ –°—Ç–µ–ø–∞–Ω –î–º–∏—Ç—Ä–æ–≤–∏—á</option>
                    <option value="4">–î–µ–º—á–µ–Ω–∫–æ –û–ª–µ–∫—Å–µ–π –ë–æ—Ä–∏—Å–æ–≤–∏—á</option>
                    <option value="5">–ö—É–∑–Ω–µ—Ü–æ–≤ –°–µ—Ä–≥—ñ–π –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á</option>
                    <option value="6">–§–µ—Å–µ—á–∫–æ –û–ª–µ–∫—Å–∞–Ω–¥—Ä –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á</option>
                    <option value="7">–ö–æ–≤–∞–ª—å—á—É–∫ –û–ª–µ–≥ –ü–µ—Ç—Ä–æ–≤–∏—á</option>
                    <option value="8">–í–∞—Ä–µ–Ω—á—É–∫ –°–µ—Ä–≥—ñ–π –ê–Ω–∞—Ç–æ–ª—ñ–π–æ–≤–∏—á</option>
                    <option value="9">–§–∞—ó–Ω –ê–Ω–¥—Ä—ñ–π –ê–ª—å–±–µ—Ä—Ç–æ–≤–∏—á</option>
                    <option value="10">–Ñ–∂–¥—ñ–Ω –û–ª–µ–∫—Å–∞–Ω–¥—Ä</option>
                    <option value="11">–ö–∏—Ä–∏–ª–æ–≤ –†–æ—Å—Ç–∏—Å–ª–∞–≤ –ú–∏—Ö–∞–π–ª–æ–≤–∏—á</option>
                </select>
            </div>
            <div class="grid-2">
                <div class="form-group">
                    <label for="truck">–¢—è–≥–∞—á</label>
                    <input type="text" id="truck" readonly style="background: #f8f9fa;">
                </div>
                <div class="form-group">
                    <label for="trailer">–ü—Ä–∏—á—ñ–ø</label>
                    <input type="text" id="trailer" readonly style="background: #f8f9fa;">
                </div>
            </div>
        </div>

        <div class="card">
            <h2>üìç –ú–∞—Ä—à—Ä—É—Ç</h2>
            <div class="form-group">
                <label for="fromCity">üö© –ó–≤—ñ–¥–∫–∏</label>
                <input type="text" id="fromCity" placeholder="–ö–∏—ó–≤" autocomplete="off">
            </div>
            <div class="form-group">
                <label for="toCity">üèÅ –ö—É–¥–∏</label>
                <input type="text" id="toCity" placeholder="–õ—å–≤—ñ–≤" autocomplete="off">
            </div>
        </div>

        <div class="card">
            <h2>üóìÔ∏è –î–∞—Ç–∏ —Ä–µ–π—Å—É</h2>
            <div class="grid-2">
                <div class="form-group">
                    <label for="startDate">–ü–æ—á–∞—Ç–æ–∫ —Ä–µ–π—Å—É *</label>
                    <input type="datetime-local" id="startDate">
                </div>
                <div class="form-group">
                    <label for="endDate">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–µ–π—Å—É *</label>
                    <input type="datetime-local" id="endDate">
                </div>
            </div>
            <div id="duration" style="display: none;" class="auto-calc">
                <div class="auto-calc-item">
                    <span style="font-weight: 600;">‚è±Ô∏è –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å:</span>
                    <span id="durationText" style="font-weight: 700; color: var(--primary);">0 –¥–Ω—ñ–≤</span>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>üì¶ –í–∞–Ω—Ç–∞–∂</h2>
            <div class="form-group">
                <label for="cargo">–ù–∞–π–º–µ–Ω—É–≤–∞–Ω–Ω—è –≤–∞–Ω—Ç–∞–∂—É</label>
                <input type="text" id="cargo" placeholder="–ü—Ä–æ–¥—É–∫—Ü—ñ—è —Ö–∞—Ä—á–æ–≤–∞, –±—É–¥–º–∞—Ç–µ—Ä—ñ–∞–ª–∏, —Ç–æ—â–æ">
            </div>
        </div>

        <div class="card">
            <h2>üöó –ü–æ–∫–∞–∑–∞–Ω–Ω—è –æ–¥–æ–º–µ—Ç—Ä–∞</h2>
            <div class="grid-2">
                <div class="form-group">
                    <label for="odomStart">–û–¥–æ–º–µ—Ç—Ä –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ *</label>
                    <div class="input-group">
                        <input type="number" id="odomStart" value="0">
                        <span class="input-suffix">–∫–º</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="odomEnd">–û–¥–æ–º–µ—Ç—Ä –≤ –∫—ñ–Ω—Ü—ñ *</label>
                    <div class="input-group">
                        <input type="number" id="odomEnd" value="0">
                        <span class="input-suffix">–∫–º</span>
                    </div>
                </div>
            </div>
            <div id="mileage" style="display: none;" class="auto-calc">
                <div class="auto-calc-item">
                    <span style="font-weight: 600;">üìè –ü—Ä–æ–±—ñ–≥ –∑–∞ —Ä–µ–π—Å:</span>
                    <span id="mileageText" style="font-weight: 700; color: var(--primary);">0 –∫–º</span>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>‚õΩ –ü–æ–∫–∞–∑–∞–Ω–Ω—è –ø–∞–ª–∏–≤–∞</h2>
            <div class="grid-2">
                <div class="form-group">
                    <label for="fuelStart">–ü–∞–ª–∏–≤–æ –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ *</label>
                    <div class="input-group">
                        <input type="number" id="fuelStart" value="0">
                        <span class="input-suffix">–ª</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="fuelEnd">–ü–∞–ª–∏–≤–æ –≤ –∫—ñ–Ω—Ü—ñ *</label>
                    <div class="input-group">
                        <input type="number" id="fuelEnd" value="0">
                        <span class="input-suffix">–ª</span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="fuelRefill">–ó–∞–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –¥–æ—Ä–æ–∑—ñ *</label>
                <div class="input-group">
                    <input type="number" id="fuelRefill" value="0">
                    <span class="input-suffix">–ª</span>
                </div>
            </div>
            <div id="fuelCalc" style="display: none;" class="auto-calc">
                <div class="auto-calc-item">
                    <span>–í–∏—Ç—Ä–∞—á–µ–Ω–æ –ø–∞–ª–∏–≤–∞:</span>
                    <span id="fuelUsed" style="font-weight: 700;">0 –ª</span>
                </div>
                <div class="auto-calc-item">
                    <span>–§–∞–∫—Ç–∏—á–Ω–∞ –≤–∏—Ç—Ä–∞—Ç–∞:</span>
                    <span id="fuelConsumption" style="font-weight: 700; color: var(--primary);">0 –ª/100–∫–º</span>
                </div>
            </div>
        </div>

        <button class="btn" onclick="generateWaybill()">üñ®Ô∏è –°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –ø—É—Ç–∏–≤–Ω–∏–π –ª–∏—Å—Ç</button>
        <button class="btn" onclick="saveWaybill()" style="background: linear-gradient(135deg, #9C27B0 0%, #7B1FA2 100%);">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –ø—É—Ç–∏–≤–Ω–∏–π –ª–∏—Å—Ç (HTML)</button>
    </div>

    <script>
        const drivers = [
            { name: "–°—Ç–∞—Ä–æ–¥—É–± –°–µ—Ä–≥—ñ–π –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", truck: "BH5291PX", trailer: "–í–ù4453XF" },
            { name: "–ù–∞—Ä–∏–≤–æ–Ω—á–∏–∫ –û–ª–µ–∫—Å–∞–Ω–¥—Ä –í–∞—Å–∏–ª—å–æ–≤–∏—á", truck: "–í–ù5651–†–í", trailer: "–í–ù4453XF" },
            { name: "–î–∏–º–æ–≥–ª–æ–≤ –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤–∏—á", truck: "BH4721PH", trailer: "–í–ù4453XF" },
            { name: "–¢—É—Ä–∫—ñ–≤ –°—Ç–µ–ø–∞–Ω –î–º–∏—Ç—Ä–æ–≤–∏—á", truck: "–í–ù7532–†–°", trailer: "–í–ù4453XF" },
            { name: "–î–µ–º—á–µ–Ω–∫–æ –û–ª–µ–∫—Å–µ–π –ë–æ—Ä–∏—Å–æ–≤–∏—á", truck: "–í–ù4853–†–ê", trailer: "–í–ù1697–†–Ü" },
            { name: "–ö—É–∑–Ω–µ—Ü–æ–≤ –°–µ—Ä–≥—ñ–π –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á", truck: "–í–ù4721–†–í", trailer: "–í–ù1697–†–Ü" },
            { name: "–§–µ—Å–µ—á–∫–æ –û–ª–µ–∫—Å–∞–Ω–¥—Ä –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á", truck: "–í–ù5829–†–°", trailer: "–í–ù7766–†–¢" },
            { name: "–ö–æ–≤–∞–ª—å—á—É–∫ –û–ª–µ–≥ –ü–µ—Ç—Ä–æ–≤–∏—á", truck: "–í–ù5291–†–ê", trailer: "–í–ù7766–†–¢" },
            { name: "–í–∞—Ä–µ–Ω—á—É–∫ –°–µ—Ä–≥—ñ–π –ê–Ω–∞—Ç–æ–ª—ñ–π–æ–≤–∏—á", truck: "–í–ù3721–†–í", trailer: "–í–ù9052–†–ê" },
            { name: "–§–∞—ó–Ω –ê–Ω–¥—Ä—ñ–π –ê–ª—å–±–µ—Ä—Ç–æ–≤–∏—á", truck: "–í–ù6328–†–í", trailer: "–í–ù9052–†–ê" },
            { name: "–Ñ–∂–¥—ñ–Ω –û–ª–µ–∫—Å–∞–Ω–¥—Ä", truck: "–í–ù7104–†–°", trailer: "–í–ù6745–†–ê" },
            { name: "–ö–∏—Ä–∏–ª–æ–≤ –†–æ—Å—Ç–∏—Å–ª–∞–≤ –ú–∏—Ö–∞–π–ª–æ–≤–∏—á", truck: "–í–ù8217–†–í", trailer: "–í–ù6745–†–ê" }
        ];

        function selectDriver() {
            const idx = document.getElementById('driver').value;
            if (idx !== "") {
                const driver = drivers[idx];
                document.getElementById('truck').value = driver.truck;
                document.getElementById('trailer').value = driver.trailer;
            }
        }

        // Calculate duration
        ['startDate', 'endDate'].forEach(id => {
            document.getElementById(id).addEventListener('change', () => {
                const start = new Date(document.getElementById('startDate').value);
                const end = new Date(document.getElementById('endDate').value);
                if (start && end && end > start) {
                    const diff = end - start;
                    const days = Math.ceil(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor(diff / (1000 * 60 * 60));
                    const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    document.getElementById('durationText').textContent = 
                        `${days} –¥–Ω. (${hours} –≥–æ–¥ ${mins} —Ö–≤)`;
                    document.getElementById('duration').style.display = 'block';
                }
            });
        });

        // Calculate mileage
        ['odomStart', 'odomEnd'].forEach(id => {
            document.getElementById(id).addEventListener('input', () => {
                const start = parseFloat(document.getElementById('odomStart').value) || 0;
                const end = parseFloat(document.getElementById('odomEnd').value) || 0;
                if (end > start) {
                    const mileage = end - start;
                    document.getElementById('mileageText').textContent = mileage + ' –∫–º';
                    document.getElementById('mileage').style.display = 'block';
                }
            });
        });

        // Calculate fuel
        ['fuelStart', 'fuelEnd', 'fuelRefill'].forEach(id => {
            document.getElementById(id).addEventListener('input', () => {
                const start = parseFloat(document.getElementById('fuelStart').value) || 0;
                const end = parseFloat(document.getElementById('fuelEnd').value) || 0;
                const refill = parseFloat(document.getElementById('fuelRefill').value) || 0;
                const odomStart = parseFloat(document.getElementById('odomStart').value) || 0;
                const odomEnd = parseFloat(document.getElementById('odomEnd').value) || 0;
                
                const used = start + refill - end;
                const mileage = odomEnd - odomStart;
                const consumption = mileage > 0 ? (used / mileage * 100) : 0;
                
                if (used > 0) {
                    document.getElementById('fuelUsed').textContent = used.toFixed(1) + ' –ª';
                    document.getElementById('fuelConsumption').textContent = consumption.toFixed(2) + ' –ª/100–∫–º';
                    document.getElementById('fuelCalc').style.display = 'block';
                }
            });
        });

        function generateWaybill() {
            const driver = document.getElementById('driver');
            if (!driver.value) {
                alert('–í–∏–±–µ—Ä—ñ—Ç—å –≤–æ–¥—ñ—è!');
                return;
            }

            const driverName = driver.options[driver.selectedIndex].text;
            const truck = document.getElementById('truck').value;
            const trailer = document.getElementById('trailer').value;
            const fromCity = document.getElementById('fromCity').value || '‚Äî';
            const toCity = document.getElementById('toCity').value || '‚Äî';
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const cargo = document.getElementById('cargo').value || '‚Äî';
            const odomStart = document.getElementById('odomStart').value;
            const odomEnd = document.getElementById('odomEnd').value;
            const fuelStart = document.getElementById('fuelStart').value;
            const fuelEnd = document.getElementById('fuelEnd').value;
            const fuelRefill = document.getElementById('fuelRefill').value;

            const mileage = odomEnd - odomStart;
            const fuelUsed = parseFloat(fuelStart) + parseFloat(fuelRefill) - parseFloat(fuelEnd);
            const consumption = mileage > 0 ? (fuelUsed / mileage * 100).toFixed(2) : 0;

            const formatDate = (dateStr) => {
                if (!dateStr) return '‚Äî';
                const d = new Date(dateStr);
                return d.toLocaleString('uk-UA');
            };

            const html = `
                <div id="waybillPrint" style="padding: 30px; font-family: Arial; max-width: 800px; margin: 0 auto;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h1 style="font-size: 20px;">–ü–£–¢–ò–í–ù–ò–ô –õ–ò–°–¢</h1>
                        <p style="color: #666; font-size: 12px;">–≤–∞–Ω—Ç–∞–∂–Ω–æ–≥–æ –∞–≤—Ç–æ–º–æ–±—ñ–ª—è</p>
                    </div>
                    
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600; width: 35%; background: #f5f5f5;">–í–æ–¥—ñ–π:</td>
                            <td style="padding: 6px; border: 1px solid #000;">${driverName}</td>
                        </tr>
                        <tr>
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600; background: #f5f5f5;">–¢—è–≥–∞—á:</td>
                            <td style="padding: 6px; border: 1px solid #000;">${truck}</td>
                        </tr>
                        <tr>
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600; background: #f5f5f5;">–ü—Ä–∏—á—ñ–ø:</td>
                            <td style="padding: 6px; border: 1px solid #000;">${trailer}</td>
                        </tr>
                    </table>
                    
                    <h3 style="margin: 15px 0 8px 0; border-bottom: 2px solid #0057B7;">–ú–ê–†–®–†–£–¢</h3>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600; width: 35%; background: #f5f5f5;">–ó–≤—ñ–¥–∫–∏:</td>
                            <td style="padding: 6px; border: 1px solid #000;">${fromCity}</td>
                        </tr>
                        <tr>
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600; background: #f5f5f5;">–ö—É–¥–∏:</td>
                            <td style="padding: 6px; border: 1px solid #000;">${toCity}</td>
                        </tr>
                        <tr>
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600; background: #fff3e0;">–í–∞–Ω—Ç–∞–∂:</td>
                            <td style="padding: 6px; border: 1px solid #000; background: #fff3e0; font-weight: 600;">${cargo}</td>
                        </tr>
                        <tr>
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600; background: #f5f5f5;">–ü–æ—á–∞—Ç–æ–∫:</td>
                            <td style="padding: 6px; border: 1px solid #000;">${formatDate(startDate)}</td>
                        </tr>
                        <tr>
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600; background: #f5f5f5;">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è:</td>
                            <td style="padding: 6px; border: 1px solid #000;">${formatDate(endDate)}</td>
                        </tr>
                    </table>
                    
                    <h3 style="margin: 15px 0 8px 0; border-bottom: 2px solid #0057B7;">–ü–û–ö–ê–ó–ê–ù–ù–Ø –ü–†–ò–õ–ê–î–Ü–í</h3>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr style="background: #f5f5f5;">
                            <th style="padding: 6px; border: 1px solid #000; width: 35%;"></th>
                            <th style="padding: 6px; border: 1px solid #000; text-align: center;">–ù–∞ –ø–æ—á–∞—Ç–æ–∫</th>
                            <th style="padding: 6px; border: 1px solid #000; text-align: center;">–í –∫—ñ–Ω—Ü—ñ</th>
                        </tr>
                        <tr>
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600;">–û–¥–æ–º–µ—Ç—Ä (–∫–º):</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${odomStart}</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${odomEnd}</td>
                        </tr>
                        <tr style="background: #e3f2fd;">
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600;">–ü—Ä–æ–±—ñ–≥ –∑–∞ —Ä–µ–π—Å:</td>
                            <td colspan="2" style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: 700; color: #0057B7;">${mileage} –∫–º</td>
                        </tr>
                        <tr>
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600;">–ü–∞–ª–∏–≤–æ (–ª):</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${fuelStart}</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${fuelEnd}</td>
                        </tr>
                        <tr style="background: #fff3e0;">
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600;">–ó–∞–ø—Ä–∞–≤–ª–µ–Ω–æ:</td>
                            <td colspan="2" style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: 700;">${fuelRefill} –ª</td>
                        </tr>
                        <tr>
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600;">–í–∏—Ç—Ä–∞—á–µ–Ω–æ:</td>
                            <td colspan="2" style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: 700;">${fuelUsed.toFixed(1)} –ª</td>
                        </tr>
                        <tr style="background: #e3f2fd;">
                            <td style="padding: 6px; border: 1px solid #000; font-weight: 600;">–í–∏—Ç—Ä–∞—Ç–∞:</td>
                            <td colspan="2" style="padding: 6px; border: 1px solid #000; text-align: center; font-weight: 700; color: #0057B7;">${consumption} –ª/100–∫–º</td>
                        </tr>
                    </table>
                    
                    <div style="margin-top: 40px;">
                        <table style="width: 100%;">
                            <tr>
                                <td style="width: 50%;">–í–æ–¥—ñ–π: ___________________</td>
                                <td style="width: 50%; text-align: right;">–î–∏—Å–ø–µ—Ç—á–µ—Ä: ___________________</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div class="no-print" style="text-align: center; margin-top: 30px;">
                        <button onclick="window.print()" style="padding: 15px 30px; background: #0057B7; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; margin-right: 10px;">üñ®Ô∏è –î—Ä—É–∫—É–≤–∞—Ç–∏</button>
                        <button onclick="document.getElementById('waybillPrint').remove()" style="padding: 15px 30px; background: #6c757d; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">‚úï –ó–∞–∫—Ä–∏—Ç–∏</button>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', html);
            document.getElementById('waybillPrint').scrollIntoView({ behavior: 'smooth' });
        }

        function saveWaybill() {
            generateWaybill();
            setTimeout(() => {
                const wb = document.getElementById('waybillPrint');
                if (!wb) return;
                
                const truck = document.getElementById('truck').value;
                const odomStart = document.getElementById('odomStart').value;
                const odomEnd = document.getElementById('odomEnd').value;
                const driver = document.getElementById('driver');
                const driverName = driver.options[driver.selectedIndex].text.split(' ')[0];
                
                const filename = `${truck}_${odomStart}-${odomEnd}_${driverName}.html`;
                
                const html = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>–ü—É—Ç–∏–≤–Ω–∏–π –ª–∏—Å—Ç</title></head><body>' + wb.innerHTML + '</body></html>';
                const blob = new Blob([html], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                URL.revokeObjectURL(url);
                
                alert('‚úÖ –ü—É—Ç–∏–≤–Ω–∏–π –ª–∏—Å—Ç –∑–±–µ—Ä–µ–∂–µ–Ω–æ!\n\n–§–∞–π–ª: ' + filename);
            }, 500);
        }
    </script>
</body>
</html>
